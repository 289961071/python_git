#!/usr/bin/python
# -*- coding:utf8 -*-
import pymssql

server = "ali-rds-02-o.sqlserver.rds.aliyuncs.com"
port = 3433
user = "lilu"
pwd = "Qq123456!@#"
con = pymssql.connect(host=server, port=3433, user=user, password=pwd, database='katespadewechat', )
# 接收返回值
cuesor = con.cursor()
ziduan = ["13908465333",
          "15576635379",
          "15874212479",
          "13802269981",
          "13603013080",
          "13910648334",
          "13717672156",
          "18610285809",
          "13811650257",
          "13501000244",
          "15047457877",
          "15911071352",
          "13811893885",
          "13717923402",
          "13426237228",
          "18610008580",
          "18601021467",
          "18201240526",
          "13699196056",
          "17600937512",
          "18210780048",
          "13693244496",
          "17745019056",
          "14784718509",
          "15910405617",
          "18610298759",
          "13260193706",
          "13031028181",
          "13791323500",
          "15085599888",
          "13467048068",
          "15811271986",
          "15010006887",
          "15300020913",
          "15810331731",
          "15801358372",
          "13810063201",
          "13683283969",
          "18500417820",
          "13761334175",
          "13661737792",
          "13795481870",
          "15921662459",
          "18008538056",
          "15821456490",
          "15921738217",
          "13305702668",
          "13564792476",
          "13917598378",
          "13817589326",
          "13524984551",
          "15000912348",
          "17317895298",
          "13509899877",
          "13818449082",
          "15800832517",
          "1.35018E+11",
          "17871159520",
          "13625768111",
          "13065721112",
          "15900954347",
          "13524620789",
          "13816263253",
          "13671735245",
          "13818295364",
          "15921592744",
          "13916254350",
          "13761261552",
          "13500379469",
          "18071154628",
          "13813829017",
          "13057598266",
          "15271700011",
          "18606199567",
          "13720222626",
          "17660082737",
          "15881271578",
          "18190293795",
          "13540517553",
          "18200353976",
          "13508169668",
          "15208412698",
          "18049373777",
          "13759959551",
          "13991175171",
          "15809216025",
          "18066910026",
          "13565307889",
          "18180785296",
          "18277232199",
          "13039995533",
          "18343105555",
          "13315010018",
          "15865258980",
          "15688487881",
          "13705406758",
          "13915551016",
          "13615310982",
          "13866719612",
          "13085059559",
          "18226636272",
          "15391989488",
          "13869884119",
          "13868131251",
          "18678205419",
          "18770072756",
          "18701219339",
          "18801079420",
          "18612097276",
          "18911177247",
          "18611960753",
          "18841185209",
          "18717711576",
          "18623402532",
          "18908354958",
          "18951773257",
          "18651652790",
          "18913816122",
          "18627813556",
          "18717128170",
          "18615751180",
          "18628135878",
          "18683290807",
          "18780179456",
          "18660272881",
          "18663995505",
          "18955199159",
          "18753295069"
          ]


def chaxun(ziduan):
    for i in ziduan:
        cuesor.execute(" select openid from sysuserinfo where Mobile=%s", i)
        row = cuesor.fetchall()
        # print('row 00 ',row[0][0])
        if row and row[0] != '' and row[0][0] != '':
            if len(row) > 0:
                cuesor.execute(" select * from WXTemplateMsgSend  where WXTemplateMsgInfoid  =19 and fansopenid=%s",
                               row[0])
                row1 = cuesor.fetchall()
                if row1:
                    print(i, '-----', row[0], '存在', row1)
                else:
                    print(i, '存在openid', row[0], '不存在模板消息')
        else:
            print(i, '不存在openid')


chaxun(ziduan)
cuesor.close()
con.close()
